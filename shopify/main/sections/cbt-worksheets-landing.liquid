<section class="cbt-landing">
  <div class="cbt-landing__hero">
    <div class="cbt-landing__hero-content">
      {% if section.settings.hero_title != blank %}
        <h1 class="cbt-landing__hero-title">{{ section.settings.hero_title }}</h1>
      {% endif %}
      {% if section.settings.hero_subtitle != blank %}
        <p class="cbt-landing__hero-subtitle">{{ section.settings.hero_subtitle }}</p>
      {% endif %}
      {% liquid
        assign has_bullets = false
        for block in section.blocks
          if block.type == 'hero_bullet'
            assign has_bullets = true
            break
          endif
        endfor
      %}
      {% if has_bullets %}
        <ul class="cbt-landing__hero-bullets">
          {% for block in section.blocks %}
            {% if block.type == 'hero_bullet' %}
              <li class="cbt-landing__hero-bullet" {{ block.shopify_attributes }}>
                {{ block.settings.bullet_text }}
              </li>
            {% endif %}
          {% endfor %}
        </ul>
      {% endif %}
      {% if section.settings.hero_cta_text != blank and section.settings.hero_cta_link != blank %}
        <a class="cbt-landing__hero-cta" href="{{ section.settings.hero_cta_link }}">
          {{ section.settings.hero_cta_text }}
        </a>
      {% endif %}
    </div>
    {% if section.settings.hero_image != blank %}
      <div class="cbt-landing__hero-media">
        {{ section.settings.hero_image | image_url: width: 1200 | image_tag: loading: 'lazy', class: 'cbt-landing__hero-image' }}
      </div>
    {% endif %}
  </div>

  {% liquid
    assign has_inside_items = false
    assign has_benefit_items = false
    assign has_who_items = false
    assign has_testimonials = false
    assign has_guarantees = false
    assign has_final_ctas = false

    for block in section.blocks
      case block.type
        when 'inside_item'
          assign has_inside_items = true
        when 'benefit_item'
          assign has_benefit_items = true
        when 'who_item'
          assign has_who_items = true
        when 'testimonial'
          assign has_testimonials = true
        when 'guarantee'
          assign has_guarantees = true
        when 'final_cta'
          assign has_final_ctas = true
      endcase
    endfor
  %}

  {% if has_inside_items %}
    <section class="cbt-landing__section cbt-landing__section--inside">
      <h2 class="cbt-landing__section-title">What's inside</h2>
      <ul class="cbt-landing__list">
        {% for block in section.blocks %}
          {% if block.type == 'inside_item' %}
            <li class="cbt-landing__list-item" {{ block.shopify_attributes }}>
              {{ block.settings.item_text }}
            </li>
          {% endif %}
        {% endfor %}
      </ul>
    </section>
  {% endif %}

  {% if has_benefit_items %}
    <section class="cbt-landing__section cbt-landing__section--benefits">
      <h2 class="cbt-landing__section-title">Benefits</h2>
      <ul class="cbt-landing__list">
        {% for block in section.blocks %}
          {% if block.type == 'benefit_item' %}
            <li class="cbt-landing__list-item" {{ block.shopify_attributes }}>
              {{ block.settings.item_text }}
            </li>
          {% endif %}
        {% endfor %}
      </ul>
    </section>
  {% endif %}

  {% if has_who_items %}
    <section class="cbt-landing__section cbt-landing__section--who">
      <h2 class="cbt-landing__section-title">Who it's for</h2>
      <ul class="cbt-landing__list">
        {% for block in section.blocks %}
          {% if block.type == 'who_item' %}
            <li class="cbt-landing__list-item" {{ block.shopify_attributes }}>
              {{ block.settings.item_text }}
            </li>
          {% endif %}
        {% endfor %}
      </ul>
    </section>
  {% endif %}

  {% if has_testimonials %}
    <section class="cbt-landing__section cbt-landing__section--testimonials">
      <h2 class="cbt-landing__section-title">Testimonials</h2>
      <div class="cbt-landing__testimonials">
        {% for block in section.blocks %}
          {% if block.type == 'testimonial' %}
            <article class="cbt-landing__testimonial" {{ block.shopify_attributes }}>
              {% if block.settings.quote != blank %}
                <blockquote class="cbt-landing__testimonial-quote">{{ block.settings.quote }}</blockquote>
              {% endif %}
              {% if block.settings.name != blank %}
                <p class="cbt-landing__testimonial-name">{{ block.settings.name }}</p>
              {% endif %}
            </article>
          {% endif %}
        {% endfor %}
      </div>
    </section>
  {% endif %}

  {% if has_guarantees %}
    <section class="cbt-landing__section cbt-landing__section--guarantee">
      {% for block in section.blocks %}
        {% if block.type == 'guarantee' %}
          <div class="cbt-landing__guarantee" {{ block.shopify_attributes }}>
            {% if block.settings.guarantee_title != blank %}
              <h3 class="cbt-landing__section-title">{{ block.settings.guarantee_title }}</h3>
            {% endif %}
            {% if block.settings.guarantee_text != blank %}
              <p class="cbt-landing__guarantee-text">{{ block.settings.guarantee_text }}</p>
            {% endif %}
          </div>
        {% endif %}
      {% endfor %}
    </section>
  {% endif %}

  {% if has_final_ctas %}
    <section class="cbt-landing__section cbt-landing__section--final-cta">
      {% for block in section.blocks %}
        {% if block.type == 'final_cta' %}
          {% if block.settings.final_cta_text != blank and block.settings.final_cta_link != blank %}
            <a class="cbt-landing__final-cta" href="{{ block.settings.final_cta_link }}" {{ block.shopify_attributes }}>
              {{ block.settings.final_cta_text }}
            </a>
          {% endif %}
        {% endif %}
      {% endfor %}
    </section>
  {% endif %}
</section>

<style>
  .cbt-landing {
    display: flex;
    flex-direction: column;
    gap: 3rem;
    padding: 3rem 1rem;
  }
  .cbt-landing__hero {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;
    align-items: center;
  }
  .cbt-landing__hero-title {
    font-size: clamp(2rem, 4vw, 3rem);
    margin-bottom: 0.75rem;
  }
  .cbt-landing__hero-subtitle {
    font-size: 1.125rem;
    margin-bottom: 1.5rem;
  }
  .cbt-landing__hero-bullets,
  .cbt-landing__list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: grid;
    gap: 0.75rem;
  }
  .cbt-landing__hero-bullets {
    margin-bottom: 1.5rem;
  }
  .cbt-landing__hero-bullet::before,
  .cbt-landing__list-item::before {
    content: '\2713';
    margin-right: 0.5rem;
    color: #008060;
  }
  .cbt-landing__hero-cta,
  .cbt-landing__final-cta {
    display: inline-block;
    background-color: #008060;
    color: #fff;
    padding: 0.75rem 1.5rem;
    border-radius: 4px;
    text-decoration: none;
    font-weight: 600;
  }
  .cbt-landing__hero-media {
    text-align: center;
  }
  .cbt-landing__hero-image {
    width: 100%;
    height: auto;
    border-radius: 12px;
  }
  .cbt-landing__section-title {
    font-size: 1.5rem;
    margin-bottom: 1rem;
  }
  .cbt-landing__testimonials {
    display: grid;
    gap: 1.5rem;
  }
  .cbt-landing__testimonial {
    padding: 1.5rem;
    border: 1px solid #e2e2e2;
    border-radius: 8px;
    background: #fff;
  }
  .cbt-landing__testimonial-quote {
    font-style: italic;
    margin: 0 0 0.75rem;
  }
  .cbt-landing__testimonial-name {
    font-weight: 600;
    margin: 0;
  }
  .cbt-landing__guarantee {
    padding: 1.5rem;
    border-radius: 8px;
    background: #f6f6f6;
  }
</style>

{% schema %}
{
  "name": "CBT Worksheets Landing",
  "settings": [
    {
      "type": "text",
      "id": "hero_title",
      "label": "Hero title"
    },
    {
      "type": "text",
      "id": "hero_subtitle",
      "label": "Hero subtitle"
    },
    {
      "type": "image_picker",
      "id": "hero_image",
      "label": "Hero image"
    },
    {
      "type": "text",
      "id": "hero_cta_text",
      "label": "Hero button text"
    },
    {
      "type": "url",
      "id": "hero_cta_link",
      "label": "Hero button link"
    }
  ],
  "blocks": [
    {
      "type": "hero_bullet",
      "name": "Hero bullet",
      "limit": 6,
      "settings": [
        {
          "type": "text",
          "id": "bullet_text",
          "label": "Bullet text"
        }
      ]
    },
    {
      "type": "inside_item",
      "name": "Inside item",
      "settings": [
        {
          "type": "text",
          "id": "item_text",
          "label": "Item text"
        }
      ]
    },
    {
      "type": "benefit_item",
      "name": "Benefit item",
      "settings": [
        {
          "type": "text",
          "id": "item_text",
          "label": "Benefit text"
        }
      ]
    },
    {
      "type": "who_item",
      "name": "Who item",
      "settings": [
        {
          "type": "text",
          "id": "item_text",
          "label": "Description"
        }
      ]
    },
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "text",
          "id": "name",
          "label": "Name"
        },
        {
          "type": "textarea",
          "id": "quote",
          "label": "Quote"
        }
      ]
    },
    {
      "type": "guarantee",
      "name": "Guarantee",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "guarantee_title",
          "label": "Guarantee title"
        },
        {
          "type": "textarea",
          "id": "guarantee_text",
          "label": "Guarantee text"
        }
      ]
    },
    {
      "type": "final_cta",
      "name": "Final CTA",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "final_cta_text",
          "label": "Final button text"
        },
        {
          "type": "url",
          "id": "final_cta_link",
          "label": "Final button link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "CBT Worksheets Landing",
      "blocks": [
        {
          "type": "hero_bullet"
        },
        {
          "type": "inside_item"
        },
        {
          "type": "benefit_item"
        },
        {
          "type": "who_item"
        },
        {
          "type": "testimonial"
        },
        {
          "type": "guarantee"
        },
        {
          "type": "final_cta"
        }
      ]
    }
  ]
}
{% endschema %}
