<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>{{ page_title | escape }}</title>
    <link rel="icon" href="{{ 'favicon.svg' | asset_url }}" type="image/svg+xml">
    {{ content_for_header }}
    {{ 'theme.css' | asset_url | stylesheet_tag }}
  </head>
  <body>
    <header class="site-header">
      <div class="site-branding">
        <img
          src="{{ 'psychology-logo.svg' | asset_url }}"
          alt="Illustrated psychology press logo showing an open book"
          width="96"
          height="96"
          class="site-logo"
        >
        <div class="site-brand-copy">
          <p class="site-subtitle">
            Curating psychology books, therapeutic workbooks, and reflective practices for every stage of healing.
          </p>
        </div>
      </div>
    </header>
    <main class="site-main" role="main">
      {{ content_for_layout }}
    </main>
    <footer class="site-footer">
      <small>&copy; {{ 'now' | date: '%Y' }} {{ shop.name }}</small>
    </footer>
    {{ content_for_footer }}
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        var countdowns = document.querySelectorAll('[data-countdown-hours]');

        countdowns.forEach(function (timer) {
          var hours = parseFloat(timer.dataset.countdownHours);
          if (isNaN(hours) || hours <= 0) {
            return;
          }

          var targetTime = Date.now() + hours * 60 * 60 * 1000;
          var container = timer.closest('[data-countdown-container]');
          var finalText = container && container.dataset.countdownFinal ? container.dataset.countdownFinal : 'Sale ended';
          var intervalId;

          function render() {
            var diff = targetTime - Date.now();

            if (diff <= 0) {
              if (container) {
                container.textContent = finalText;
              } else {
                timer.textContent = finalText;
              }

              if (intervalId) {
                clearInterval(intervalId);
              }
              return;
            }

            var totalSeconds = Math.floor(diff / 1000);
            var hrs = Math.floor(totalSeconds / 3600);
            var mins = Math.floor((totalSeconds % 3600) / 60);
            var secs = totalSeconds % 60;

            timer.textContent = [hrs, mins, secs]
              .map(function (value) {
                return String(value).padStart(2, '0');
              })
              .join(':');
          }

          render();
          intervalId = window.setInterval(render, 1000);
        });
      });
    </script>
  </body>
</html>
