{%- assign hero_excerpt = product.description | strip_html | truncatewords: 40 -%}

<section class="landing-hero product-hero">
  <div class="hero-content">
    {%- if product.vendor != blank -%}
      <span class="hero-badge">{{ product.vendor }}</span>
    {%- endif -%}
    <h1>{{ product.title }}</h1>
    {%- if hero_excerpt != blank -%}
      <p>{{ hero_excerpt }}</p>
    {%- else -%}
      <p>An immersive psychology edition designed to guide you through reflective practices, lyrical stories, and
        community rituals.</p>
    {%- endif -%}
    <div class="hero-actions">
      <a class="button button-primary" href="#product-purchase">Reserve your copy</a>
      <a class="button button-secondary" href="#inside-the-book">See what's inside</a>
    </div>
    <ul class="hero-highlights">
      <li>
        {%- if product.compare_at_price > product.price -%}
          Introductory price {{ product.price | money }} (Reg. {{ product.compare_at_price | money }})
        {%- else -%}
          Collector's edition {{ product.price | money }}
        {%- endif -%}
      </li>
      <li>Worldwide shipping plus digital ritual companion access</li>
      <li>Crafted with premium materials for lasting inspiration</li>
    </ul>
  </div>
  <div class="hero-visual">
    {%- if product.featured_media -%}
      <figure class="product-hero-visual">
        {{ product.featured_media | media_tag: class: 'product-hero-image', loading: 'eager' }}
        {%- if product.featured_media.alt != blank -%}
          <figcaption class="visually-hidden">{{ product.featured_media.alt }}</figcaption>
        {%- endif -%}
      </figure>
    {%- else -%}
      <div class="product-hero-placeholder">Imagery coming soon</div>
    {%- endif -%}
  </div>
</section>

<section id="inside-the-book" class="landing-section product-story">
  <header class="section-header">
    <h2>Inside "{{ product.title }}"</h2>
    <p>Immerse yourself in richly layered storytelling, reflective prompts, and guided practices that invite daily
      integration.</p>
  </header>
  <div class="product-story-content">
    {%- if product.description != blank -%}
      {{ product.description }}
    {%- else -%}
      <p>We are curating the full narrative description. Check back soon for a chapter-by-chapter overview.</p>
    {%- endif -%}
  </div>
</section>

<section class="landing-section product-features">
  <header class="section-header">
    <h2>Crafted for meaningful transformation</h2>
    <p>Every detail of {{ product.title }} invites you to slow down, breathe deeply, and translate insight into rituals.
    </p>
  </header>
  <div class="features-grid">
    <article class="feature-card">
      <h3>Integration rituals</h3>
      <p>Curated therapeutic practices to integrate each chapter.</p>
    </article>
    <article class="feature-card">
      <h3>Artful keepsake</h3>
      <p>Thoughtfully designed print with premium, eco-conscious materials.</p>
    </article>
    <article class="feature-card">
      <h3>Community access</h3>
      <p>Complimentary guided meditations and discussion circles to continue the journey.</p>
    </article>
  </div>
</section>

<section class="landing-section alt product-experience">
  <div class="section-content">
    <header class="section-header">
      <h2>Bring the experience into your space</h2>
      <p>Set the stage for evenings of reflection, creative restoration, and meaningful dialogue with those you love.</p>
    </header>
    <ul class="hero-highlights product-experience-list">
      <li>Downloadable soundscapes and journaling prompts for each reading session</li>
      <li>Access to live annotation salons with the author and fellow readers</li>
      <li>Beautiful packaging perfect for gifting or displaying in your studio</li>
    </ul>
  </div>
  <div class="section-visual">
    <div class="quote-card">
      <blockquote>"This edition feels like a gentle mentorâ€”part science, part poetry, entirely transformative."</blockquote>
      <cite>&mdash; Selah, Narrative Therapist</cite>
    </div>
  </div>
</section>

<section id="product-purchase" class="landing-section product-purchase">
  <header class="section-header">
    <h2>Reserve your copy of {{ product.title }}</h2>
    <p>Secure a beautifully crafted edition and receive immediate access to the digital ritual library.</p>
  </header>
  <div class="purchase-panel">
    <div class="purchase-pricing">
      <span class="purchase-price">{{ product.price | money }}</span>
      {%- if product.compare_at_price > product.price -%}
        <span class="purchase-compare">{{ product.compare_at_price | money }}</span>
      {%- endif -%}
    </div>

      {%- assign form_id = 'product-form-' | append: product.id -%}
      {%- assign quantity_id = 'quantity-' | append: product.id -%}
      {%- form 'product', product, id: form_id, class: 'product-purchase-form' -%}
        {%- if product.variants.size > 1 -%}
          <label class="purchase-label" for="variant-select-{{ product.id }}">Choose your edition</label>
          <select id="variant-select-{{ product.id }}" name="id">
            {%- for variant in product.variants -%}
              <option value="{{ variant.id }}" {%- if variant == product.selected_or_first_available_variant -%}selected{%- endif -%} {%- unless variant.available -%}disabled{%- endunless -%}>
                {{ variant.title }} &mdash; {{ variant.price | money }}{%- unless variant.available -%} (Sold out){%- endunless -%}
              </option>
            {%- endfor -%}
          </select>
        {%- else -%}
          <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
        {%- endif -%}

        <label class="purchase-label" for="{{ quantity_id }}">Quantity</label>
        <input id="{{ quantity_id }}" type="number" name="quantity" value="1" min="1" class="purchase-quantity"{% unless product.available %} disabled{% endunless %}>

        <div class="purchase-actions">
          <button type="submit" class="button button-primary" name="add"{% unless product.available %} disabled{% endunless %}>Add to cart</button>
          <button type="submit" class="button button-buy-now" formmethod="post" formaction="{{ routes.cart_add_url }}?return_to=/checkout"{% unless product.available %} disabled{% endunless %}>Buy now</button>
        </div>

      {%- endform -%}
    </div>
  </section>
