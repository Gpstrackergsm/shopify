{%- if product == blank -%}
  <section class="product-unavailable">
    <div class="product-unavailable__content">
      <h1>Product coming soon</h1>
      <p>We're preparing our next release. Please check back soon for full details.</p>
    </div>
  </section>
{%- else -%}
  <section class="product" aria-labelledby="product-title">
    <div class="product__grid">
      <div class="product__media">
        {%- if product.media.size > 0 -%}
          <div class="product__media-gallery" role="list">
            {%- for media in product.media -%}
              <figure class="product__media-item" role="listitem">
                {{
                  media
                  | media_tag:
                    class: 'product__media-image',
                    loading: 'lazy',
                    image_size: '2048x2048'
                }}
                {%- if media.alt != blank -%}
                  <figcaption class="visually-hidden">{{ media.alt }}</figcaption>
                {%- endif -%}
              </figure>
            {%- endfor -%}
          </div>
        {%- else -%}
          <div class="product__media-placeholder">No media available</div>
        {%- endif -%}
      </div>

      <div class="product__details">
        <header class="product__header">
          <h1 id="product-title">{{ product.title }}</h1>
          {%- if product.vendor != blank -%}
            <p class="product__vendor">By {{ product.vendor }}</p>
          {%- endif -%}
        </header>

        <div class="product__pricing">
          {%- assign primary_variant = product.selected_or_first_available_variant -%}
          <span class="product__price">{{ primary_variant.price | money }}</span>
          {%- if primary_variant.compare_at_price > primary_variant.price -%}
            <span class="product__price--compare">{{ primary_variant.compare_at_price | money }}</span>
          {%- endif -%}
        </div>

        {%- if product.description != blank -%}
          <div class="product__description">{{ product.description }}</div>
        {%- endif -%}

        {%- form 'product', product, class: 'product-form' -%}
          {{ form.errors | default_errors }}
          {%- if product.variants.size > 1 -%}
            <label class="product-form__label" for="VariantSelector-{{ form.id }}">Choose an option</label>
            <select
              id="VariantSelector-{{ form.id }}"
              name="id"
              class="product-form__select"
            >
              {%- for variant in product.variants -%}
                <option
                  value="{{ variant.id }}"
                  {%- if variant == product.selected_or_first_available_variant -%} selected{%- endif -%}
                  {%- unless variant.available -%} disabled{%- endunless -%}
                >
                  {{ variant.title }}{%- unless variant.available -%} â€” Sold out{%- endunless -%}
                </option>
              {%- endfor -%}
            </select>
          {%- else -%}
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
          {%- endif -%}

          <label class="product-form__label" for="Quantity-{{ form.id }}">Quantity</label>
          <input
            id="Quantity-{{ form.id }}"
            class="product-form__input"
            type="number"
            name="quantity"
            min="1"
            value="1"
          >

          {{ form | payment_terms }}

          <button
            type="submit"
            name="add"
            class="product-form__submit"
            {%- unless product.available -%} disabled{%- endunless -%}
          >
            {%- if product.available -%}Add to cart{%- else -%}Sold out{%- endif -%}
          </button>

          {%- if product.available -%}
            <div class="product-form__payment-button">
              {{ form | payment_button }}
            </div>
          {%- endif -%}
        {%- endform -%}
      </div>
    </div>
  </section>
{%- endif -%}
